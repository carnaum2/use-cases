Date: 30-10-2017

This file contains a high level description of the new churn model process.

---------------------------
Mobile-Only MonoLine Churn
---------------------------

The churn propensity list for Mobile-Only Monoline customers is generated by the following steps.

1. Obtain the Mobile-Only Monoline customers

0_get_mobile_only_customers.R

It applies the filters in the specific flags of the AC_FINAL_POSPAGO to get those Mobile-Only Monoline customers.

Parameters: Month information as YYYYMM indicating the end of one month.
Input:      EXTR_AC_FINAL_POSPAGO in R data.table format
            EXTR_NIFS_COMPARTIDOS_YYYYMM
Output:     A list of NIFs (National IDs) in R data.table format, corresponding to those Mobile Only Monoline Customers.


2. Obtain the CAR information for those Mobile-Only Monoline Customers

1_get_mobile_only_car.R

It gets the CAR information fot those Mobile-Only Monoline Customers

Parameters: Month information as YYYYMM indicating the end of one month. 
Input:      PAR_EXPLIC_LIN_6M_YYYYMM.txt in plain text format.
Outout:     A file named dt.car.mo.RData containing the CAR information for those Mobile-Only Monoline customers.

3. Prepare the dataset for {training|testing|prediction}

2_prepare_mobile_only_train_dataset.R
2_prepare_mobile_only_test_dataset.R
2_prepare_mobile_only_predict_dataset.R

The next step is to prepare the dataset for training a model; or a dataset for testing a model that is already trained; or a dataset to predict the list for a specific End-Of-Month.
The main differences from these 3 scripts, are:

- Train: We use the CAR and the Discounts information, we do feature selection by removing Near-Zero-Variance variables and assign NA values to -1 ;remove those port-outs requests for the next month and lable the TARGET using the port-outs requests at M+2.

- Test: We use the CAR and the Discounts information, but we do not do any feature selection step, only assing NA values to -1. We remove those port-outs requests at M+1 and use the TARGET label of port-outs at M+2.

- Predict: We use the CAR and the Discounts information, set the NA values to -1, but we don't set any information about the TARGET. 

2_prepare_mobile_only_train_dataset.R

Parameters: The input CAR month as YYYYMMM, the  Month+1 YYYYMM+1 for port-out requests, and YYYYMM+2 for port-out requests.
Input: The mobile-only mono-line customer CAR and the port-outs requests for month M+1 and month M+2 
Output: dt.test.mo.YYYYMM.YYYYMM+2.RData

2_prepare_mobile_only_test_dataset.R

Parameters: The input CAR month as YYYYMMM, the  Month+1 YYYYMM+1 for port-out requests, and YYYYMM+2 for port-out requests.
Input:  The mobile-only mono-line customer CAR and the port-outs requests for month M+1 and month M+2 
Output: dt.test.mo.YYYYMM.YYYYMM+2.RData

2_prepare_mobile_only_predict_dataset.R

Parameters: The input month YYYYMM
Input:      The mobile-only mono-line customer CAR
Output:     dt.test.mo.YYYYMM.RData

4. Train a Machine Learning Model

3_train_mobile_only_model.R

In this script we compute a ML model. Several models were tried but we end-up training a GBM model.

Parameters:
  The CAR Month: "201707"
  The Port-Out requests Month: "201709"
  The number of trees: 500
  The name of the model: "h2ogbm"
  If we use a validation month: "none"
Input: dt.train.mo.YYYYMM.YYYYMM.RData
Output: The predictive model











